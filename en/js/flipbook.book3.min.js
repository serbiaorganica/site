/* v 3.4.5
author http://codecanyon.net/user/creativeinteractivemedia/portfolio?ref=creativeinteractivemedia
*/
var FLIPBOOK=FLIPBOOK||{};FLIPBOOK.Book3=function(t,i,e){this.options=e,this.model=i,this.singlePage=e.singlePageMode,this.pageWidth=this.options.pageWidth,this.pageHeight=this.options.pageHeight,this.wrapper=t,this.$wrapper=jQuery(this.wrapper).addClass("flipbook-book3"),this.$bookLayer=this.$wrapper.parent(),this.bookLayer=this.$bookLayer[0],this.flipEasing="easeInOutCubic",this.scroll=new FLIPBOOK.IScroll(this.bookLayer,{zoom:!0,scrollX:!0,scrollY:!0,scrollbars:!0,keepInCenterV:!0,keepInCenterH:!0,preventDefault:!1});var s=this;this.scroll&&this.scroll.on("zoomEnd",function(){if(isNaN(s.scroll.scale))s.zoomTo(e.zoomMin);else{e.main.onZoom(s.scroll.scale/s.ratio);var t=e.main.zoom;s.scroll.options.eventPassthrough=t>1?"":"vertical",s.scroll.options.scrollY=t>1,s.scroll.options.freeScroll=t>1,s.scroll.refresh()}});var o,n=this.wrapper.style;n.width=String(2*this.pageWidth)+"px",n.height=String(this.pageHeight)+"px",this.$centerContainer=jQuery("<div>").appendTo(this.$wrapper).addClass("flipbook-center-container3"),this.options.singlePageMode&&this.$centerContainer.css({"perspective-origin-x":"0","-webkit-perspective-origin-x":"0"}),this.centerContainerStyle=this.$centerContainer[0].style,this.centerContainerStyle.width=2*this.pageWidth+"px",this.centerContainerStyle.height=this.pageHeight+"px",this.pagesArr=[],this.animating=!1,this.setRightIndex(e.rightToLeft?e.pages.length:0),this.flippedleft=this.rightIndex,this.flippedright=e.pages.length-this.rightIndex,this.numPages=e.pages.length;for(var h=0;h<e.pages.length;h++)o=new FLIPBOOK.Page3(this,h,e.pages[h].src,e.pages[h].htmlContent),this.pagesArr.push(o),this.$centerContainer.append(o.$wrapper),this.flippedright++;this.pagesArr[0].show(),this.nextEnabled=!0,this.prevEnabled=!0},FLIPBOOK.Book3.prototype={},FLIPBOOK.Book3.prototype.enableMouseWheelZoom=function(){this.scroll.options.eventPassthrough="vertical",this.scroll.refresh()},FLIPBOOK.Book3.prototype.disableMouseWheelZoom=function(){this.scroll.options.eventPassthrough="",this.scroll.refresh()},FLIPBOOK.Book3.prototype.enablePrev=function(t){this.prevEnabled=t},FLIPBOOK.Book3.prototype.setRightIndex=function(t){this.rightIndex=t},FLIPBOOK.Book3.prototype.enableNext=function(t){this.nextEnabled=t},FLIPBOOK.Book3.prototype.isZoomed=function(){return this.options.zoom>this.options.zoomMin&&this.options.zoom>1},FLIPBOOK.Book3.prototype.onZoom=function(){},FLIPBOOK.Book3.prototype.getNumPages=function(){},FLIPBOOK.Book3.prototype.zoomTo=function(t,i,e,s){if(this.enabled){e=e||0,s=s||0,i=i||0;this.scroll&&this.scroll.zoom(t*this.ratio,e,s,i)}},FLIPBOOK.Book3.prototype.updateBookPosition=function(){if(this.options.singlePageMode)return this.$wrapper.width(this.pageWidth),this.scroll&&this.scroll.refresh(),this.focusBoth(),this.view=1,void this.focusLeft();1==this.view?this.$wrapper.width(this.pageWidth):this.$wrapper.width(2*this.pageWidth),this.scroll&&this.scroll.refresh(),2==this.view?this.isCover()?this.focusRight():this.isBackCover()?this.focusLeft():this.focusBoth():1==this.view&&(this.isCover()?this.focusRight():this.isBackCover()&&this.focusLeft())},FLIPBOOK.Book3.prototype.focusLeft=function(t,i){var e=1==this.view?0:this.pageWidth/2;this.setBookPosition(e,t,i)},FLIPBOOK.Book3.prototype.focusRight=function(t,i){var e=1==this.view?-this.pageWidth:-this.pageWidth/2;this.setBookPosition(e,t,i)},FLIPBOOK.Book3.prototype.focusBoth=function(t,i){var e=1==this.view?-this.pageWidth/2:0;this.setBookPosition(e,t,i)},FLIPBOOK.Book3.prototype.setBookPosition=function(t,i,e){if(this.centerContainerPosition!=t){var s=this.centerContainerPosition;if(i){var o=this;e=e||0,jQuery({someValue:s}).delay(e).animate({someValue:t},{duration:i,easing:this.flipEasing,step:function(t){o._setStyle(o.centerContainerStyle,FLIPBOOK.IScroll.utils.style.transform,"translateX("+t+"px) translateZ(0)")},complete:function(){o.centerContainerPosition=t}})}else{var n="translateX("+t+"px)";this.centerContainerPosition=t,this._setStyle(this.centerContainerStyle,FLIPBOOK.IScroll.utils.style.transform,n)}}},FLIPBOOK.Book3.prototype.updateVisiblePages=function(t){void 0===t&&(t=!0);for(var i=this,e=FLIPBOOK.IScroll.utils.style.transform,s=0;s<this.pagesArr.length;s++)s==this.flippedleft?this.pagesArr[s].show():s!=this.flippedleft-1||this.options.singlePageMode?this.pagesArr[s].hide():this.pagesArr[s].show(),this.pagesArr[s]._setZIndex(0),this.pagesArr[s]._setStyle(this.pagesArr[s].wrapper.style,e,"");this.updateBookPosition();var o=this.pagesArr[this.rightIndex],n=this.pagesArr[this.rightIndex-1],h=this.pagesArr[this.rightIndex+1],r=this.pagesArr[this.rightIndex+2],a=this.pagesArr[this.rightIndex-2],p=this.pagesArr[this.rightIndex-3];n?(i.options.main.setLoadingProgress(.1),n.load(function(){i.options.main.setLoadingProgress(1),o?o.load(function(){i.options.main.setLoadingProgress(1),a&&a.load(),p&&p.load(),h&&h.load(),r&&r.load()}):(a&&a.load(),p&&p.load())})):(i.options.main.setLoadingProgress(.1),o.load(function(){i.options.main.setLoadingProgress(1),h&&h.load(),r&&r.load()}))},FLIPBOOK.Book3.prototype.enable=function(){this.onResize(),this.enabled=!0},FLIPBOOK.Book3.prototype.disable=function(){this.onResize(),this.enabled=!1},FLIPBOOK.Book3.prototype.getLeftPage=function(){return this.pagesArr[this.flippedleft-1]},FLIPBOOK.Book3.prototype.getRightPage=function(){return this.pagesArr[this.flippedleft]},FLIPBOOK.Book3.prototype.getLeftBackPage=function(){return this.pagesArr[this.flippedleft-2]},FLIPBOOK.Book3.prototype.getRightBackPage=function(){return this.pagesArr[this.flippedleft+1]},FLIPBOOK.Book3.prototype.getNextPage=function(){return this.pagesArr[this.flippedleft+2]},FLIPBOOK.Book3.prototype.getPrevPage=function(){return this.pagesArr[this.flippedleft-3]},FLIPBOOK.Book3.prototype.nextPage=function(){if(this.nextEnabled)if(1!=this.view||!this.isFocusedLeft()||this.options.singlePageMode){var t=this.options.singlePageMode?this.rightIndex+1:this.rightIndex+2;this.goToPage(t)}else{var i=1e3*this.options.pageFlipDuration/2;this.focusRight(i)}},FLIPBOOK.Book3.prototype.prevPage=function(){if(this.prevEnabled)if(1!=this.view||!this.isFocusedRight()||this.options.singlePageMode){var t=this.options.singlePageMode?this.rightIndex-1:this.rightIndex-2;this.goToPage(t)}else{var i=1e3*this.options.pageFlipDuration/2;this.focusLeft(i)}},FLIPBOOK.Book3.prototype.goToPage=function(t,i){if(this.enabled&&!this.flipping)if(t<0&&(t=0),this.options.singlePageMode?t>this.pagesArr.length&&(t=this.pagesArr.length):(t%2!=0&&t--,t>this.pagesArr.length&&(t=this.pagesArr.length)),t!=this.rightIndex){if(i)return this.flippedleft=t,this.flippedright=this.pagesArr.length-t,this.setRightIndex(t),this.updateVisiblePages(),void this.options.main.turnPageComplete();this.flipping=!0;var e=this.flipEasing;void 0===jQuery.easing[e]&&this.options.main.initEasing();var s=1e3*this.options.pageFlipDuration;this.options.singlePageMode||(1==this.view?t<this.rightIndex?this.focusRight(s):this.focusLeft(s):0==t?this.focusRight(s):t==this.pagesArr.length?this.focusLeft(s):this.focusBoth(s));var o=this;this.goingToPage=t,t>this.rightIndex?(end=180,(o.angle<=0||o.angle>=180||!o.angle)&&(o.angle=1)):t<this.rightIndex&&(end=-180,(o.angle>=0||o.angle<=-180||!o.angle)&&(o.angle=-1)),this.options.singlePageMode&&(s/=2),jQuery({someValue:o.angle}).animate({someValue:end},{duration:s,easing:e,step:function(t){o._setPageAngle(t)},complete:function(){o.setRightIndex(t),o.flippedleft=t,o.flippedright=o.pagesArr.length-t,o.updateVisiblePages(),o.angle=0,o.flipping=!1,o.options.main.turnPageComplete()}}),o.options.main.playFlipSound()}else this.options.main.turnPageComplete()},FLIPBOOK.Book3.prototype.onSwipe=function(t,i,e,s,o,n,h){if(!this.isZoomed()&&"flipbook-page-link"!=t.target.className&&"start"!=i&&"up"!=e&&"down"!=e&&(s=h[0].start.x-h[0].end.x,!this.flipping)){console.log(e);var r=180*s/this.model.wrapperW;if("cancel"==i&&n<=1&&(r>0?this.nextPage():r<0&&this.prevPage()),"end"==i&&n<=1&&(r>0?this.nextPage():r<0&&this.prevPage()),"move"==i&&n<=1){if(r>0){if(!this.nextEnabled)return;if(this.options.singlePageMode&&this.rightIndex==this.pagesArr.length-1)return;this.goingToPage=this.options.singlePageMode?this.rightIndex+1:this.rightIndex+2}else if(r<0){if(!this.prevEnabled)return;this.goingToPage=this.options.singlePageMode?this.rightIndex-1:this.rightIndex-2}this.goingToPage!=this.rightIndex&&this.goingToPage>=0&&this.goingToPage<=this.pagesArr.length&&this._setPageAngle(r)}}},FLIPBOOK.Book3.prototype._setStyle=function(t,i,e){t&&(t[i]=e)},FLIPBOOK.Book3.prototype._setPageAngle=function(t){var i,e,s,o;if(this.angle=t,this.options.singlePageMode)t>0?((s=this.pagesArr[this.rightIndex])._setAngle(t/2),e=this.pagesArr[this.goingToPage],s.shadow.style.opacity=(t-30)/900,e&&(e.show(),e.shadow.style.opacity=1-t/90)):((o=this.pagesArr[this.goingToPage]).show(),o._setAngle(t/2+90),o.shadow.style.opacity=(180+t-30)/900,(s=this.pagesArr[this.rightIndex]).shadow.style.opacity=1-(180+t)/90);else if(t>0){if(1==this.view&&this.isFocusedLeft())return;s=this.pagesArr[this.rightIndex],o=this.pagesArr[this.goingToPage-1],this.applyAngles(s,o,t,90,0),e=this.pagesArr[o.index+1],s.shadow.style.opacity=(t-10)/600,o.shadow.style.opacity=(180-t-10)/600,e&&e.show()}else{if(1==this.view&&this.isFocusedRight())return;o=this.pagesArr[this.rightIndex-1],s=this.pagesArr[this.goingToPage],this.applyAngles(s,o,t,-90,180),o.shadow.style.opacity=(-t-10)/600,s.shadow.style.opacity=(180+t-10)/600,(i=this.pagesArr[this.goingToPage-1])&&i.show()}},FLIPBOOK.Book3.prototype.isCover=function(){return 0==this.rightIndex},FLIPBOOK.Book3.prototype.isBackCover=function(){return this.rightIndex==this.pagesArr.length},FLIPBOOK.Book3.prototype.applyAngles=function(t,i,e,s,o){e<s?(t&&(t._setAngle(e+o),t.show()),i&&i.hide()):(i&&(i._setAngle(e+o),i.show()),t&&t.hide())},FLIPBOOK.Book3.prototype.onPageLoaded=function(t,i){var e=t;this.options.rightToLeft&&(e=this.options.pages.length-t-1);var s=this.options.pages[t].canvas[this.options.pageTextureSize],o=this.options.pages[t].htmlContent;this.pagesArr[e].setMat(s,o,this.options.rightToLeft)},FLIPBOOK.Book3.prototype.onPageUnloaded=function(t,i){var e=t;this.options.rightToLeft&&(e=this.options.pages.length-t-1),this.pagesArr[e].unload()},FLIPBOOK.Book3.prototype.onResize=function(){var t=this.model,i=t.wrapperW,e=t.wrapperH,s=t.bookW,o=t.bookH,n=t.pageW,h=t.pageH,r=i/e,a=n/h,p=(this.options.main,this.options),g=this;function l(){g.ratio=e/o,c()}function d(){g.ratio=1==g.view?i/n:i/s,c()}function c(){g.scroll&&(g.scroll.options.zoomMin=g.ratio*p.zoomMin),g.scroll&&(g.scroll.options.zoomMax=g.ratio*p.zoomMax),g.updateBookPosition(),g.scroll&&g.scroll.zoom(g.ratio*p.zoom,i/2,e/2,0)}Math.min(this.zoom,1),Number(this.options.zoomMin);this.options.responsiveView&&i<=this.options.responsiveViewTreshold&&r<2*a?(this.view=1,i/e>n/h?l():d()):(this.view=2,i/e>=s/o?l():d()),this.updateBookPosition()},FLIPBOOK.Book3.prototype.isFocusedRight=function(){var t=1==this.view?-this.pageWidth/2:0;return this.centerContainerPosition<t},FLIPBOOK.Book3.prototype.isFocusedLeft=function(){var t=1==this.view?-this.pageWidth/2:0;return this.centerContainerPosition>t},FLIPBOOK.Page3=function(t,i,e,s){this.book=t,this.options=t.options,this.texture=e,this.html=s,this.index=i,this.$wrapper=jQuery("<div>").addClass("flipbook-page3").width(t.options.pageWidth).height(t.options.pageHeight),this.wrapper=this.$wrapper[0],this.$image=jQuery("<div>").appendTo(this.$wrapper).addClass("flipbook-page3-image"),this.$canvas=jQuery("<div>").appendTo(this.$wrapper).addClass("flipbook-page3-html"),this.$shadow=jQuery("<div>").appendTo(this.$wrapper).addClass("flipbook-page3-shadow"),this.shadow=this.$shadow[0],this.hidden=!1,this.hide(),this.zIndex=0,this.options.singlePageMode?(this.$wrapper.addClass("flipbook-page3-front"),this.type="front"):i%2==0?(this.$wrapper.css("left",String(this.book.options.pageWidth-1)+"px").addClass("flipbook-page3-front"),this.type="front"):(this.$wrapper.addClass("flipbook-page3-back"),this.type="back")},FLIPBOOK.Page3.prototype={load:function(t){if(1!=this.loaded){this.loaded=!0;var i=this,e=i.options.rightToLeft?this.book.pagesArr.length-this.index-1:this.index;i.options.pdfMode?this.options.main.loadPage(e,this.options.pageTextureSize,function(){t&&t.call(i)}):this.options.main.loadPage(e,this.options.pageTextureSize,function(e){var s=document.createElement("img");s.src=e.image.src;e.image.naturalHeight;var o=e.image.naturalHeight,n=(i.options.pageWidth,i.options.pageHeight,0);"left"==i.options.pages[e.index].side?scaleX=2:"right"==i.options.pages[e.index].side?(n="-50% ",scaleX=2):scaleX=1,jQuery(s).appendTo(i.$image).css("transform","scaleX("+scaleX+") translateX("+n+") translateZ(0)"),e.htmlContent&&jQuery(e.htmlContent).appendTo(i.$canvas),i.$wrapper.css("background","none"),t&&t.call(i)})}else t&&t.call(this)},unload:function(){this.loaded=!1,this.mat=!1},setMat:function(t,i,e){this.mat||(this.mat=!0,this.$canvas.empty(),jQuery(t).appendTo(this.$canvas),this.$wrapper.css("background","none"),this.options.doublePage&&0!=this.index&&this.index%2==0||jQuery(i).appendTo(this.$canvas))},setDataUrl:function(t,i){var e=this;this.$img.attr("src",t),this.$img[0].onload=function(){e.$wrapper.css({background:"none"})},e.html&&jQuery(e.html).appendTo(e.$canvas)},show:function(){this.hidden&&(this.$wrapper[0].style.display="block",this.shadow.style.opacity="0"),this.hidden=!1},hide:function(){this.hidden||(this.$wrapper[0].style.display="none",this.shadow.style.opacity="0"),this.hidden=!0},_setScale:function(t){if(this.scale!=t){var i=FLIPBOOK.IScroll.utils.style.transform,e="scaleX("+String(t)+") translateZ(0)";this.scale=t,this._setStyle(i,e)}},_setAngle:function(t){if(this.angle!=t){this.angle=t;var i,e,s=FLIPBOOK.IScroll.utils.style.transform;"3d"==this.book.options.viewMode?i="front"==this.type?"rotateY("+String(-t)+"deg) translateZ(0)":"rotateY("+String(180-t)+"deg) translateZ(0)":"2d"==this.book.options.viewMode&&("front"==this.type?(t>90&&(t=90),i="scaleX("+String((180-2*t)/180)+") translateZ(0)"):(t<90&&(t=90),i="scaleX("+String(2*t/180-1)+") translateZ(0)")),this._setStyle(this.wrapper.style,s,i);var o=0;for(e=0;e<this.book.pagesArr.length;e++)e!=this.index&&this.book.pagesArr[e].zIndex>o&&(o=this.book.pagesArr[e].zIndex);this._setZIndex(o+1)}},_setZIndex:function(t){this.zIndex!=t&&(this.wrapper.style["z-index"]=t),this.zIndex=t},_setStyle:function(t,i,e){t&&(t[i]=e)}};